<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Tribes vengeance Server Browser</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
<!-- font from www.webpagepublicity.com -->
<style type="text/css">
@font-face {
 font-family: phoenix_font;
 src: url('http://dl.dropbox.com/u/39786635/alexisitalic.ttf');
}
@font-face {
 font-family: be_font;
 src: url('http://dl.dropbox.com/u/39786635/anythingyouwant.ttf');
}
@font-face {
 font-family: imp_font;
 src: url('http://dl.dropbox.com/u/39786635/aldosnova.ttf');
}
.cell {
 display: table-cell;
 padding-right : 10px
}
.BloodEagle {
 color: #8A0829;
 font-weight: bold;
 font-family: be_font;
}
.Imperial {
 color: #0404B4;
 font-family: imp_font;
}
.Phoenix {
 color: #868A08;
 font-family: phoenix_font;
}
</style>
<script type="text/javascript">//<![CDATA[
var debug = ""

$(document).ready(function() {
  $("a").live('click', function(e) {
    debug = ""
    e.preventDefault();
    $('#spinner').show();
    href = $(this).attr("href")

    $.getJSON(href,
      function(json) {
        if (href == "/list.json"){
          $('#servers').empty();
          $( "#serversTemplate" ).tmpl( json ).appendTo( "#servers" );
        } else {
           $('#server').empty();
          $( "#serverTemplate" ).tmpl( json ).appendTo( "#server" );
        }
      }).error(function(jx, txt, err) { alert(txt + "(" +err+ ") :" + jx.responseText); })
        .complete(function(){
          $('#spinner').hide();
          $('#debug').html(debug);
        });
  })

$('#_server_tmpl').hide();
$('#_servers_tmpl').hide();
$('#spinner').hide();
});
//]]></script>

<script id="serversTemplate" type="text/x-jquery-tmpl">
  <li><a href="/${ip}/${port}.json">${hostname}</a> (${numplayers}/${maxplayers})</li>
</script>

<script id="serverTemplate" type="text/x-jquery-tmpl">
 <div><b>${name}</b> (Password? : ${password})</div>
 <div>Players : ${numplayers} / ${maxplayers}</div>
 <div>{{tmpl(admin) "#adminTemplate"}}</div>
 <div>{{tmpl(game) "#gameTemplate"}}</div>
</script>

<script id="adminTemplate" type="text/x-jquery-tmpl">Admin : ${name} (${email})</script>

<script id="gameTemplate" type="text/x-jquery-tmpl">
 <div>Map : ${map} (${gametype})</div>
 <div>Scores : {{tmpl(team1) "#teamTemplate"}} / {{tmpl(team2) "#teamTemplate"}}</div>
 <div class="players" style="display: table">
  <div style="display: table-row; font-weight:bold">
   <span class="cell">Player</span>
   <span class="cell">ping</span>
   <span class="cell">team</span>
   <span class="cell">score</span>
  </div>
  {{tmpl(players) "#playerTemplate"}}
  </div>
</script>

<script id="teamTemplate" type="text/x-jquery-tmpl">
  {{tmpl(name) "#teamNameTemplate"}} ${score}
</script>
<script id="teamNameTemplate" type="text/x-jquery-tmpl">
 <span class='${$item.data.replace(" ", "")}' >${$item.data}</span>
</script>

<script id="playerTemplate" type="text/x-jquery-tmpl">
  <div class="subelem" style="display: table-row">
   <span class="cell" >${name}</span>
   <span class="cell" >${ping}</span>
   <span class="cell" >{{if team}}{{tmpl(team) "#teamNameTemplate"}}{{/if}}</span>
   <span class="cell">${score}</span>
  </div>
</script>

</head>
<body>
<a href="/list.json">Browse</a> <img src="/ajax-loader.gif" id="spinner"/>
 <ul id="servers"></ul>
 <div id="server"></div>
 <span id="debug"></span>
</body>
</html>
